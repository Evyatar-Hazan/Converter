<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>CSV to JSON Converter - Tests</title>
    <link rel="stylesheet" href="../css/styles.css">
    <style>body{padding:2rem;}</style>
</head>
<body>
    <h1>CSV to JSON - Automated Tests</h1>
    <div id="results"></div>
    <script src="../js/csv-to-json.js"></script>
    <script>
        const resultsEl = document.getElementById('results');
        function runTest(name, input, expected, shouldThrow = false) {
            const div = document.createElement('div');
            div.className = 'test-case';
            div.innerHTML = `<strong>Test: ${name}</strong><br>`;
            try {
                const result = csvToJson(input);
                if (shouldThrow) {
                    div.innerHTML += `<span class='fail'>FAIL: Expected to throw but returned result.</span>`;
                } else if (result.trim() === expected.trim()) {
                    div.innerHTML += `<span class='pass'>PASS</span>`;
                } else {
                    div.innerHTML += `<span class='fail'>FAIL</span><br>Expected:<pre>${expected}</pre>Got:<pre>${result}</pre>`;
                }
            } catch (err) {
                if (shouldThrow) {
                    div.innerHTML += `<span class='pass'>PASS (Threw as expected: ${err.message})</span>`;
                } else {
                    div.innerHTML += `<span class='fail'>FAIL: Threw unexpected error: ${err.message}</span>`;
                }
            }
            resultsEl.appendChild(div);
        }
        runTest('Simple CSV', 'a,b\n1,2', '[\n  {\n    "a": "1",\n    "b": "2"\n  }\n]');
        runTest('Multiple Rows', 'name,age\nAlice,25\nBob,30', '[\n  {\n    "name": "Alice",\n    "age": "25"\n  },\n  {\n    "name": "Bob",\n    "age": "30"\n  }\n]');
        runTest('Quoted Comma', 'name,city\n"Doe, Jane",NY', '[\n  {\n    "name": "Doe, Jane",\n    "city": "NY"\n  }\n]');
        runTest('Missing Values', 'name,title,age\nAlice,Dev,\nBob,,30', '[\n  {\n    "name": "Alice",\n    "title": "Dev",\n    "age": ""\n  },\n  {\n    "name": "Bob",\n    "title": "",\n    "age": "30"\n  }\n]');
        runTest('Unmatched Quote Error', 'name,quote\n"Alice,Hello', '', true);
        console.log('Tests complete.');
    </script>
</body>
</html>
